(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{1086:function(e,t,n){},846:function(e,t,n){"use strict";n.r(t);var r,s=n(0),c=n.n(s),o=n(7),a=n(6),h=n(34),d=n(63),y=n(2);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return!t||"object"!==u(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var m,b=Object(a.translate)("translations")(r=Object(o.connect)(function(e){return{customerAddress:e.auth.address}},null)(r=function(e){function n(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(t=l(this,f(n).call(this,e))).state={originAddress:e.address,address:e.address,error:{}},t}var t,r,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(n,c.a.Component),t=n,(r=[{key:"componentDidMount",value:function(){this.handleAutocomplete()}},{key:"handleAutocomplete",value:function(){var l=this,e=this.props,f=e.t,p=e.data,m=e.chooseAddress,h=e.customerAddress,t={lat:d.c,lng:d.d},n={bounds:new google.maps.Circle({center:t,radius:1e5}).getBounds(),componentRestrictions:{country:"vn"}},b=new google.maps.places.Autocomplete(this.addressRef,n);b.addListener("place_changed",function(){var e=b.getPlace();if(e.geometry){var t=e.geometry.location.lat(),n=e.geometry.location.lng(),r=!1,s={},o=!0,a=!1,d=void 0;try{for(var u,i=h[Symbol.iterator]();!(o=(u=i.next()).done);o=!0){var c=u.value;if(Object(y.I)(t,7)===+c.lat&&Object(y.I)(n,7)===+c.long){r=!0;break}}}catch(e){a=!0,d=e}finally{try{o||null==i.return||i.return()}finally{if(a)throw d}}r?(s.address=f("VALIDATE.ADDRESS_DUPLICATE"),m(p,e,!0)):(delete s.address,m(p,e)),l.setState({error:s})}})}},{key:"render",value:function(){var t=this,e=this.props,n=e.t,r=e.data,s=e.name,o=e.value,a=e.onFocusAddress,d=e.onBlurAddress,u=e.handleInputChange,i=this.state.error;return c.a.createElement(c.a.Fragment,null,c.a.createElement("input",{ref:function(e){return t.addressRef=e},type:"text",name:s,value:o,onFocus:function(){return a(r)},onBlur:function(){return d(r)},autoComplete:"off",className:"border-bottom",placeholder:n("PLACEHOLDER.TYPE_YOUR_ADDRESS"),onChange:function(e){return u(e,r)}}),i.address&&c.a.createElement("div",{className:"error-message"},i.address))}}])&&i(t.prototype,r),s&&i(t,s),n}())||r)||r,A=n(721),v=n(18);function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function S(e,t){return(S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function j(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var w,k=Object(a.translate)("translations")(m=Object(o.connect)(function(e){return{token:e.auth.token,customer:e.auth.customer,customerAddress:e.auth.address}},{replaceAddress:v.b})(m=function(e){function s(e){var t,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),n=this,(t=!(r=O(s).call(this,e))||"object"!==g(r)&&"function"!=typeof r?j(n):r).state={name:"",address:"",originAddress:"",lat:null,lng:null,preventUpdate:!1,error:{}},t.chooseAddress=t.chooseAddress.bind(j(j(t))),t.handleInputChange=t.handleInputChange.bind(j(j(t))),t}var t,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S(e,t)}(s,c.a.Component),t=s,(n=[{key:"handleInputChange",value:function(e){var t,n,r,s=e.target,o=s.value,a=s.name;this.setState((r=o,(n=a)in(t={})?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t))}},{key:"onFocusAddress",value:function(){this.setState({address:""})}},{key:"onBlurAddress",value:function(){this.setState({address:this.state.originAddress}),this.addAddress()}},{key:"chooseAddress",value:function(e,t,n){this.setState({address:t.formatted_address,originAddress:t.formatted_address,lat:Object(y.I)(t.geometry.location.lat(),7),lng:Object(y.I)(t.geometry.location.lng(),7),preventUpdate:n}),this.addAddress()}},{key:"addAddress",value:function(){var e=this.props,n=e.t,t=e.token,r=e.customer,s=e.customerAddress,o=e.addAddress,a=e.replaceAddress,d=this.state,u=d.name,i=d.address,c=d.lat,l=d.lng,f=d.preventUpdate,p={};if(u?delete p.name:p.name=n("VALIDATE.ENTER_ADDRESS_NAME"),c&&l?delete p.address:p.address=n("VALIDATE.CART_SELECT_ADDRESS_FROM_SUGGESTION"),0<Object.keys(p).length)this.setState({error:p});else if(f)this.setState({error:p});else{var m={customer_uuid:r.customer_uuid,name:u,address:i,lat:c,long:l};Object(A.a)(m,t).then(function(e){if(e&&!e.error){h.toast.info(n("TOAST.AddAddressSuccessfully"));var t=_(s).concat([{cus_address_uuid:e.data.cus_address_uuid,customer_uuid:r.customer_uuid,name:u,address:i,lat:c,long:l}]);o(t),a(t)}}).catch(function(e){h.toast.error(Object(y.n)(e.message))})}}},{key:"render",value:function(){var t=this,e=this.props.t,n=this.state,r=n.name,s=n.address,o=n.error;return c.a.createElement("div",{className:"info-row"},c.a.createElement("div",null,c.a.createElement("input",{type:"text",name:"name",value:r,className:"border-bottom",onBlur:function(){return t.addAddress()},placeholder:e("LABEL.NAME"),autoComplete:"off",onChange:function(e){return t.handleInputChange(e)}}),o.name&&c.a.createElement("div",{className:"error-message"},o.name)),c.a.createElement("div",null,c.a.createElement(b,{name:"address",value:s,onFocusAddress:function(){return t.onFocusAddress()},onBlurAddress:function(){return t.onBlurAddress()},handleInputChange:this.handleInputChange,chooseAddress:this.chooseAddress}),o.address&&c.a.createElement("div",{className:"error-message"},o.address)))}}])&&E(t.prototype,n),r&&E(t,r),s}())||m)||m;n(1086);function C(e){return(C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function I(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function T(e){return(T=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function R(e,t){return(R=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function D(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var N=Object(a.translate)("translations")(w=Object(o.connect)(function(e){return{isLoggedIn:e.auth.loggedIn,token:e.auth.token,address:e.auth.address,customer:e.auth.customer}},{replaceAddress:v.b})(w=function(e){function s(e){var t,n,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),n=this,(t=!(r=T(s).call(this,e))||"object"!==C(r)&&"function"!=typeof r?D(n):r).state={originAddress:e.address,address:e.address,savingAddress:!1,deletingAddress:!1,addingRow:!1,preventUpdate:!1},t.onFocusAddress=t.onFocusAddress.bind(D(D(t))),t.onBlurAddress=t.onBlurAddress.bind(D(D(t))),t.handleInputChange=t.handleInputChange.bind(D(D(t))),t.chooseAddress=t.chooseAddress.bind(D(D(t))),t.addAddress=t.addAddress.bind(D(D(t))),t}var t,n,r;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&R(e,t)}(s,c.a.Component),t=s,(n=[{key:"handleInputChange",value:function(e,t){var n=Object(y.l)(this.state.address),r=e.target,s=r.value,o=r.name,a=n.map(function(e){return e.cus_address_uuid===t.cus_address_uuid&&("name"===o&&(e.name=s),"address"===o&&(e.address=s)),e});this.setState({address:a})}},{key:"onFocusAddress",value:function(t){var e=Object(y.l)(this.state.address).map(function(e){return e.cus_address_uuid===t.cus_address_uuid&&(e.address=""),e});this.setState({address:e})}},{key:"onBlurAddress",value:function(){this.setState({address:this.state.originAddress})}},{key:"chooseAddress",value:function(t,n,e){var r=Object(y.l)(this.state.address).map(function(e){return e.cus_address_uuid===t.cus_address_uuid&&(e.address=n.formatted_address,e.lat=Object(y.I)(n.geometry.location.lat(),7),e.long=Object(y.I)(n.geometry.location.lng(),7)),e});this.setState({address:r,originAddress:r,preventUpdate:e})}},{key:"toggleCloseButton",value:function(t,n){var e=Object(y.l)(this.state.address).map(function(e){return e.cus_address_uuid===t.cus_address_uuid&&(e.selected=n),e});this.setState({address:e})}},{key:"saveAddress",value:function(){var e=this,t=this.state,n=t.address,r=t.savingAddress,s=t.preventUpdate;if(!r&&!s){this.setState({savingAddress:!0});var o=this.props,a=o.t,d=o.token,u=o.replaceAddress;Promise.all(n.map(function(r){return new Promise(function(t,n){var e={cus_address_uuid:r.cus_address_uuid,name:r.name,address:r.address,lat:+r.lat,long:+r.long};Object(A.i)(e,d).then(function(e){e&&!e.error?t(!0):n(e)})})})).then(function(){h.toast.info(a("TOAST.UpdateAddressSuccessfully")),u(n),e.setState({originAddress:n,savingAddress:!1})}).catch(function(e){h.toast.error(Object(y.n)(e.message))})}}},{key:"deleteAddress",value:function(n){var r=this,e=this.state.deletingAddress,s=Object(y.l)(this.state.address),t=this.props,o=t.t,a=t.token,d=t.replaceAddress;e||(this.setState({deletingAddress:!0}),Object(A.b)(n.cus_address_uuid,a).then(function(e){if(e&&!e.error){h.toast.info(o("TOAST.DeleteAddressSuccessfully"));var t=s.filter(function(e){return e.cus_address_uuid!==n.cus_address_uuid});r.setState({deletingAddress:!1,address:t,originAddress:t}),d(t)}}).catch(function(e){h.toast.error(Object(y.n)(e.message))}))}},{key:"addAddressRow",value:function(){this.setState({addingRow:!0})}},{key:"addAddress",value:function(e){this.setState({addingRow:!1,address:e,originAddress:e})}},{key:"render",value:function(){var n=this,e=this.props.t,t=this.state,r=t.address,s=t.savingAddress,o=t.addingRow;return c.a.createElement("div",{className:"addresses"},c.a.createElement("h3",null,e("LABEL.MY_ADDRESS")),c.a.createElement("div",{className:"info-row info-header d-none d-md-inline-flex"},c.a.createElement("div",null,c.a.createElement("label",null,e("LABEL.NAME"))),c.a.createElement("div",null,c.a.createElement("label",null,e("LABEL.ADDRESS")))),r.map(function(t){return c.a.createElement("div",{className:"info-row",onMouseEnter:function(){return n.toggleCloseButton(t,!0)},onMouseLeave:function(){return n.toggleCloseButton(t,!1)},key:t.cus_address_uuid},c.a.createElement("div",null,c.a.createElement("input",{type:"text",name:"name",value:t.name,className:"border-bottom",autoComplete:"off",placeholder:e("LABEL.NAME"),onChange:function(e){return n.handleInputChange(e,t)}})),c.a.createElement("div",null,c.a.createElement(b,{data:t,value:t.address,name:"address",onFocusAddress:n.onFocusAddress,onBlurAddress:n.onBlurAddress,handleInputChange:n.handleInputChange,chooseAddress:n.chooseAddress})),c.a.createElement("div",{className:"btn-close",onClick:function(){return n.deleteAddress(t)}}))}),o&&c.a.createElement(k,{addAddress:this.addAddress}),c.a.createElement("div",{className:"button-wrapper"},r&&0<r.length&&c.a.createElement("button",{className:"btn btn-type-2",disabled:s,onClick:function(){return n.saveAddress()}},e("BUTTON.SAVE")),c.a.createElement("button",{className:"btn btn-type-5",onClick:function(){return n.addAddressRow()}},c.a.createElement("span",{className:"btn-plus"}),e("BUTTON.ADD_ADDRESS"))))}}])&&I(t.prototype,n),r&&I(t,r),s}())||w)||w;t.default=N}}]);