(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{1057:function(e,t,r){},1058:function(e,t,r){},1104:function(e,t,r){"use strict";r.r(t);var n,o=r(0),U=r.n(o),a=r(7),i=r(6),C=r(34),O=r(275),_=r(278),c=r(734),s=r.n(c),l=r(9),f=r.n(l),u=r(16),Y=r(19),h=r(213),H=r(2),P=r(5);r(1057);function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var v,b=Object(i.translate)("translations")(n=function(e){function o(e){var t,r,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r=this,(t=!(n=p(o).call(this,e))||"object"!==d(n)&&"function"!=typeof n?g(r):n).state={detailOpened:!1},t.handleClickOutside=t.handleClickOutside.bind(g(g(t))),t}var t,r,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(o,U.a.Component),t=o,(r=[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.handleClickOutside)}},{key:"handleClickOutside",value:function(e){this.itemRef&&e.target&&e.target.parentElement&&(!this.itemRef||this.itemRef.contains(e.target)||this.itemRef.contains(e.target.nextElementSibling)||this.itemRef.contains(e.target.parentElement.nextElementSibling)||this.setState({detailOpened:!1}))}},{key:"toggleDetail",value:function(e){this.actionsRef&&this.actionsRef.contains(e.target)||this.setState({detailOpened:!this.state.detailOpened})}},{key:"onClickButtonUse",value:function(e){var t=this.props.selectVoucher;t?t(e):e.outlet&&e.outlet.slug&&P.a.push("/".concat(e.outlet.slug))}},{key:"render",value:function(){var t=this,e=this.props,r=e.t,n=e.voucher,o=e.status,a=Object(H.s)(n.amount,n.currency.symbol),i=f()(n.expires_at).format("DD/MM/YYYY"),c=n.outlet.name,s=n.outlet.logo,l=window.location.protocol+"//"+window.location.hostname+"/voucher/claim?code="+n.voucher_code,u=0;u=2===n.type?n.setting.max_shared_percent_voucher:n.setting.max_rewarded_percent_voucher;var d=r("LABEL.VOUCHER_INFO_1").replace("%@",u),m=r("LABEL.VOUCHER_INFO_2").replace("%@",n.voucher_setting.share_limit-n.share_count),p=r("LABEL.VOUCHER_INFO_3");return U.a.createElement("div",{className:"voucher-item clearfix ".concat(n.selected?"selected":""," ").concat(this.state.detailOpened?"detail-opened":""),onClick:function(e){return t.toggleDetail(e)},ref:function(e){return t.itemRef=e}},U.a.createElement("div",{className:"item-border"},2===n.type&&U.a.createElement("i",{className:"icon-hottab-people icon-sharing","aria-hidden":"true"}),U.a.createElement("div",{className:"voucher-content"},U.a.createElement("div",{className:"img-wrapper"},U.a.createElement(Y.a,{src:s,width:40,height:40})),U.a.createElement("div",{className:"voucher-info"},U.a.createElement("div",{className:"restaurant-name"},c),U.a.createElement("div",{className:"voucher-price"},a),U.a.createElement("div",{className:"voucher-expire"},r("LABEL.EXPIRE"),": ",i))),U.a.createElement("div",{className:"voucher-actions",ref:function(e){return t.actionsRef=e}},(!o||"past"!==o)&&U.a.createElement("button",{className:"btn btn-use ".concat(n.selected?"selected":""),onClick:function(){return t.onClickButtonUse(n)}},n.selected?r("BUTTON.CANCEL"):r("BUTTON.USE")),(!o||"past"!==o)&&n.is_shareable&&U.a.createElement(h.a,{name:c,url:l}),n.errorMessage&&n.active?U.a.createElement("div",{className:"voucher-error"},n.errorMessage):"")),U.a.createElement("div",{className:"voucher-detail"},U.a.createElement("ol",null,U.a.createElement("li",null,d),n.is_shareable&&U.a.createElement("li",null,m),U.a.createElement("li",null,p))))}}])&&m(t.prototype,r),n&&m(t,n),o}())||n;function E(e){return(E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function L(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function N(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var k,j=Object(i.translate)("translations")(v=function(e){function o(e){var t,r,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r=this,(t=!(n=S(o).call(this,e))||"object"!==E(n)&&"function"!=typeof n?N(r):n).state={modalOpened:!1},t.toggleModal=t.toggleModal.bind(N(N(t))),t}var t,r,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(o,U.a.Component),t=o,(r=[{key:"componentDidMount",value:function(){this.props.onItemRef&&this.props.onItemRef(this)}},{key:"toggleModal",value:function(){this.setState({modalOpened:!this.state.modalOpened})}},{key:"render",value:function(){var e=this.props,t=e.t,r=e.vouchers,n=e.selectVoucher,o=this.state.modalOpened;if(0===r.length)return null;var a=r.filter(function(e){return e.selected}).length;return U.a.createElement(u.Modal,{isOpen:o,toggle:this.toggleModal,className:this.props.className},U.a.createElement(u.ModalBody,null,U.a.createElement("div",{className:"modal-content-inner h-100"},U.a.createElement("div",{className:"close-btn",onClick:this.toggleModal}),U.a.createElement("label",null,t("LABEL.VOUCHERS")," ",0<a?"(".concat(a,")"):""),U.a.createElement("div",{className:"vouchers-container"},r.map(function(e){return U.a.createElement(b,{isModal:!0,voucher:e,selectVoucher:n,key:e.voucher_uuid})})))))}}])&&L(t.prototype,r),n&&L(t,n),o}())||v;function A(e){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function D(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function I(e){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function R(e,t){return(R=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function T(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var M,V=Object(i.translate)("translations")(k=function(e){function o(e){var t,r,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r=this,(t=!(n=I(o).call(this,e))||"object"!==A(n)&&"function"!=typeof n?T(r):n).state={modalOpened:!1},t.toggleModal=t.toggleModal.bind(T(T(t))),t.handleClickOutside=t.handleClickOutside.bind(T(T(t))),t.timeout=null,t}var t,r,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&R(e,t)}(o,U.a.Component),t=o,(r=[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.handleClickOutside)}},{key:"handleClickOutside",value:function(e){e.target&&e.target.classList.contains("btn-use")||this.props.vouchers.find(function(e){return e.errorMessage})&&(clearTimeout(this.timeout),this.timeout=setTimeout(this.props.clearVoucherError,500))}},{key:"toggleModal",value:function(){this.setState({modalOpened:!this.state.modalOpened})}},{key:"render",value:function(){var t=this,e=this.props,n=e.t,r=e.vouchers,o=e.selectVoucher,a=r.filter(function(e){return e.selected}).length,i=r.find(function(e){return e.errorMessage}),c=i?i.errorMessage:"";return U.a.createElement("div",{className:"vouchers-container"},U.a.createElement("div",{className:"voucher-header clearfix"},U.a.createElement("label",null,n("LABEL.ADD_VOUCHERS")," ",0<a?"(".concat(a,")"):""),U.a.createElement("div",{className:"voucher-more",onClick:function(){return t.voucherModal.toggleModal()}},n("LABEL.MORE"))),c?U.a.createElement("div",{className:"voucher-error"},c):"",U.a.createElement(s.a,{slidesPerView:"auto",freeMode:!0,shouldSwiperUpdate:!0,spaceBetween:10},r.map(function(e){var t=Object(H.s)(e.amount,e.currency.symbol),r=f()(e.expires_at).format("DD/MM/YYYY");return U.a.createElement("div",{className:"voucher-checkout-item ".concat(e.selected?"selected":""),key:e.voucher_uuid},2===e.type&&U.a.createElement("i",{className:"icon-hottab-people icon-sharing","aria-hidden":"true"}),U.a.createElement("div",{className:"voucher-price"},t),U.a.createElement("div",{className:"voucher-expire"},n("LABEL.EXPIRE"),": ",r),U.a.createElement("button",{className:"btn btn-use ".concat(e.selected?"selected":""),onClick:function(){return o(e)}},e.selected?n("BUTTON.CANCEL"):n("BUTTON.USE")))})),U.a.createElement(j,{onItemRef:function(e){return t.voucherModal=e},className:"modal-vertical voucher-modal",vouchers:r,selectVoucher:o}))}}])&&D(t.prototype,r),n&&D(t,n),o}())||k,x=r(29);function B(e){return(B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function F(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function G(e){return(G=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function K(e,t){return(K=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function W(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var X,z=Object(i.translate)("translations")(M=Object(a.connect)(function(e){return{lang:e.config.lang,orderType:e.config.order_type,orderItems:e.order.items,orderInfo:e.order.info,isLoggedIn:e.auth.loggedIn}},{decreaseQuantity:x.d,increaseQuantity:x.e,updateOrderInfo:x.j})(M=function(e){function o(e){var t,r,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),r=this,(t=!(n=G(o).call(this,e))||"object"!==B(n)&&"function"!=typeof n?W(r):n).state={orderNote:"",isHiddenMobile:!0},t.handleInputChange=t.handleInputChange.bind(W(W(t))),t.toggleHidden=t.toggleHidden.bind(W(W(t))),t}var t,r,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&K(e,t)}(o,U.a.Component),t=o,(r=[{key:"handleInputChange",value:function(e){var t,r,n,o=this.props.updateOrderInfo,a=e.target,i=a.value,c=a.name;"orderNote"===c&&o({orderNote:i}),this.setState((n=i,(r=c)in(t={})?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t))}},{key:"toggleHidden",value:function(){this.setState({isHiddenMobile:!this.state.isHiddenMobile})}},{key:"render",value:function(){var e=this.props,t=e.t,r=e.orderItems,n=e.orderInfo,o=e.totalPrice,a=e.taxes,i=e.deliveryFee,c=e.subtotal,s=e.isLoggedIn,l=e.orderPriceStatus,u=e.vouchers,d=e.selectVoucher,m=e.clearVoucherError,p=e.voucherAmount,f=e.orderType,h=this.state,y=h.orderNote,g=h.isHiddenMobile,v=n.online_order_setting,b=n.currency.symbol,E=n.enabled_voucher_program?f===H.b.DELIVERY?n.voucher_setting.delivery_amount:n.voucher_setting.takeaway_amount:0;return U.a.createElement("div",{className:"checkout-cart ".concat(g?"hidden-mobile":"")},U.a.createElement("div",{className:"cart-content"},U.a.createElement(_.a,null),U.a.createElement("div",{className:"total-price ".concat(3!==l?"price-disable":"")},Object(H.s)(o,b),U.a.createElement("div",{className:"btn-toggle d-lg-none",onClick:this.toggleHidden},U.a.createElement("i",{className:"icon-hottab-angle-".concat(g?"down":"up"," icon-angle")}))),1===l&&v.min_delivery_cost&&U.a.createElement("div",{className:"price-hint"},t("LABEL.MIN_ORDER"),": ",Object(H.s)(v.min_delivery_cost,b)),2===l&&v.max_delivery_cost&&U.a.createElement("div",{className:"price-hint"},t("LABEL.MAX_ORDER"),": ",Object(H.s)(v.max_delivery_cost,b)),3===l&&n.enabled_voucher_program&&n.voucher_setting&&U.a.createElement("div",{className:"voucher-hint"},t("LABEL.REWARDED_VOUCHER_AMOUNT"),": ",Object(H.s)((c-p)*E/100,b)),U.a.createElement("div",{className:"d-lg-none"},0<u.length&&U.a.createElement(V,{vouchers:u,clearVoucherError:m,selectVoucher:d})),r.map(function(e,t){return U.a.createElement(O.a,{item:e,index:t,key:"".concat(e.item_uuid,"-").concat(t)})}),U.a.createElement("div",{className:"fee"},U.a.createElement("div",{className:"fee-row"},U.a.createElement("label",null,t("LABEL.SUBTOTAL")),U.a.createElement("div",{className:"value"},Object(H.s)(c,b))),s&&n.order_type===H.b.DELIVERY&&U.a.createElement("div",{className:"fee-row"},U.a.createElement("label",null,t("LABEL.DELIVERY_FEE")),U.a.createElement("div",{className:"value"},0<i?Object(H.s)(i,b):t("LABEL.FREE_SHIPPING"))),a.map(function(e){return 0===e.amount?null:U.a.createElement("div",{className:"fee-row",key:e.tax_uuid},U.a.createElement("label",null,e.name," (",e.value,"%)"),U.a.createElement("div",{className:"value"},Object(H.s)(e.amount,b)))}),0<p&&U.a.createElement("div",{className:"fee-row"},U.a.createElement("label",null,t("LABEL.VOUCHER")),U.a.createElement("div",{className:"value"},"-",Object(H.s)(p,b)))),U.a.createElement("div",{className:"d-none d-lg-block"},0<u.length&&U.a.createElement(V,{vouchers:u,clearVoucherError:m,selectVoucher:d})),U.a.createElement("textarea",{className:"order-note",name:"orderNote",placeholder:t("LABEL.ORDER_NOTE"),value:y,onChange:this.handleInputChange})))}}])&&F(t.prototype,r),n&&F(t,n),o}())||M)||M,J=r(8),q=r(107),Q=r.n(q),$=r(739),Z=r(63);function ee(e){return(ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function te(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function re(e,t){return!t||"object"!==ee(t)&&"function"!=typeof t?function(e){if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(e):t}function ne(e){return(ne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function oe(e,t){return(oe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ae,ie=Object(a.connect)(function(e){return{isLoggedIn:e.auth.loggedIn,orderType:e.config.order_type,orderInfo:e.order.info}},null)(X=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),re(this,ne(t).apply(this,arguments))}var r,n,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oe(e,t)}(t,U.a.Component),r=t,(n=[{key:"render",value:function(){var e=this.props,t=e.orderInfo,r=e.mapOpened,n=e.orderType,o=e.isLoggedIn,a=e.customerLat,i=e.customerLng,c=e.updateDirections,s=t.lat?+t.lat:Z.c,l=t.long?+t.long:Z.d;if(!s||!l)return null;var u={lat:+s,lng:+l},d=o&&n===H.b.DELIVERY&&a&&i;return U.a.createElement("div",{className:"checkout-map ".concat(r?"":"map-hidden")},U.a.createElement($.a,{renderOnMount:!0,updateDirections:c,renderDirections:d,customerLat:a,customerLng:i,restaurantLat:s,restaurantLng:l,center:u,zoom:Z.e}))}}])&&te(r.prototype,n),o&&te(r,o),t}())||X,ce=r(22),se=(r(110),r(49)),le=r(18),ue=r(35);function de(e){return(de="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function me(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pe(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function fe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function he(e){return(he=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ye(e,t){return(ye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ge(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var ve,be=Object(i.translate)("translations")(ae=Object(a.connect)(function(e){return{lang:e.config.lang,position:e.config.position,isLoggedIn:e.auth.loggedIn,orderInfo:e.order.info,orderItems:e.order.items,customer:e.auth.customer,orderType:e.config.order_type,address:e.auth.address,customerLat:e.config.customerLat,customerLng:e.config.customerLng,customerAddress:e.config.customerAddress,paymentMethod:e.config.paymentMethod}},{setAuthState:le.g,saveUserInfo:le.f,updateOrderInfo:x.j,updateCustomerPosition:ue.i,changePaymentMethod:ue.b})(ae=function(e){function n(e){var i,t,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t=this,r=he(n).call(this,e),(i=!r||"object"!==de(r)&&"function"!=typeof r?ge(t):r).checkDeliveryRange=function(){var e=i.props,t=e.orderInfo,r=e.distance,n=e.deliveryFeeObject,o=t.online_order_setting;if(t.order_type===H.b.DELIVERY&&o.delivery_distance&&r>o.delivery_distance)return!1;var a=!!o.delivery_fee_setting&&o.delivery_fee_setting.some(function(e){return 1===e.status});return!(t.order_type===H.b.DELIVERY&&a&&!n)},i.state={phone:"",otp:"",countryCode:84,verifying:!1,otpSending:!1,btnNextDisabled:!1,btnVerifyDisabled:!1,authErrorMessage:"",address:"",originAddress:"",addressNote:"",showPredictions:!1,predictions:e.address||[],originPredictions:e.address||[],mapMobileOpened:!1,payment:"cod"},i.handleInputChange=i.handleInputChange.bind(ge(ge(i))),i.handleClickOutside=i.handleClickOutside.bind(ge(ge(i))),i.onKeyPress=i.onKeyPress.bind(ge(ge(i))),i.onFocusAddress=i.onFocusAddress.bind(ge(ge(i))),i.toggleMapMobile=i.toggleMapMobile.bind(ge(ge(i))),i.onChangePaymentMethod=i.onChangePaymentMethod.bind(ge(ge(i))),i.timeout=null,i}var t,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ye(e,t)}(n,U.a.Component),t=n,(r=[{key:"componentDidMount",value:function(){document.addEventListener("mousedown",this.handleClickOutside),this.getCurrentAddress()}},{key:"componentDidUpdate",value:function(e){e.position!==this.props.position&&this.getCurrentAddress()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("mousedown",this.handleClickOutside)}},{key:"getCurrentAddress",value:function(){var a=this,e=this.props,t=e.position,i=e.updateOrderInfo,c=e.updateCustomerPosition,r=e.customerLat,n=e.customerLng,o=e.customerAddress;if(r&&n)return this.setState({address:o,originAddress:o}),void i({customerLat:r,customerLng:n,customerAddress:o});if(t){var s={lat:t.latitude,lng:t.longitude};(new google.maps.Geocoder).geocode({location:s},function(e,t){if("OK"===t&&e[0]){var r=e[0].geometry.location.lat(),n=e[0].geometry.location.lng(),o=e[0].formatted_address;a.setState({address:o,originAddress:o}),i({customerLat:r,customerLng:n,customerAddress:o}),c({lat:r,lng:n,address:o})}})}}},{key:"handleClickOutside",value:function(e){e.target&&(!this.countriesRef||this.countriesRef.contains(e.target)||this.countriesRef.contains(e.target.parentElement.nextElementSibling)||this.setState({countriesListShow:!1}),this.addressRef&&!this.addressRef.contains(e.target)&&this.predictionsRef&&!this.predictionsRef.contains(e.target)&&this.setState({address:this.state.originAddress,predictions:this.state.originPredictions,showPredictions:!1}))}},{key:"handleInputChange",value:function(e,t){var r,n=this.props,a=n.orderInfo,o=n.updateOrderInfo,i=n.address,c=e.target,s=c.value,l=c.name;if(t){if(""!==s&&!/^[0-9\b]+$/.test(s))return!1}if("addressNote"===l&&o({addressNote:s}),"address"===l){this.timeout&&clearTimeout(this.timeout);var u=this;this.timeout=setTimeout(function(){var e=new google.maps.places.AutocompleteService,t={lat:a.lat,lng:a.long},r=new google.maps.Circle({center:t,radius:3e4}).getBounds(),n="".concat(a.lat,",").concat(a.long),o={input:s,location:n,bounds:r,componentRestrictions:{country:"vn"}};e.getPlacePredictions(o,function(e,t){var r=[],n=i.filter(function(e){return Object(H.H)(e.address.toLowerCase()).includes(Object(H.H)(s))});r="OK"===t?pe(n).concat(pe(e)):pe(n),u.setState({predictions:r})})},500)}this.setState((me(r={},l,s),me(r,"authErrorMessage",""),r))}},{key:"toggleCountriesList",value:function(){this.setState({countriesListShow:!this.state.countriesListShow})}},{key:"changeCountryCode",value:function(e){this.state.countryCode!==e&&(this.setState({countryCode:e}),this.toggleCountriesList())}},{key:"sendOtp",value:function(){var e=this.state,t=e.countryCode,r=e.phone;if(!e.btnNextDisabled&&(this.setState({btnNextDisabled:!0}),r)){var n={country_code:t,phone:r};this.doLogin(n)}}},{key:"back",value:function(){var e=this;this.setState({otp:"",authErrorMessage:"",verifying:!1},function(){e.phoneRef.focus()})}},{key:"doLogin",value:function(t){var r=this,e=this.props,n=e.t,o=e.setAuthState,a=e.saveUserInfo;Object(se.c)(t).then(function(e){r.setState({btnNextDisabled:!1,otpSending:!1}),e&&(e.error?r.setState({authErrorMessage:n("ERROR_CODE.".concat(e.message.general.code))}):t.verification_code?(a(e.data),o(!0),C.toast.info(n("TOAST.appLogin"))):r.setState({verifying:!0},function(){r.otpRef.focus()}))}).catch(function(e){r.setState({btnNextDisabled:!1,otpSending:!1}),C.toast.error(Object(H.n)(e.message))})}},{key:"login",value:function(){var e=this.state,t=e.countryCode,r=e.phone,n=e.otp;if(n){var o={country_code:t,phone:r,verification_code:n,pin:!1};this.doLogin(o)}}},{key:"onKeyPress",value:function(e){"Enter"==e.key&&this.sendOtp()}},{key:"onFocusAddress",value:function(){this.setState({address:"",showPredictions:!0})}},{key:"choosePrediction",value:function(e){var a=this,t=this.props,i=t.updateOrderInfo,c=t.updateCustomerPosition;(this.setState({showPredictions:!1}),e.address)?(i({customerLat:+e.lat,customerLng:+e.long,customerAddress:e.address}),this.setState({address:e.address,originAddress:e.address}),c({lat:+e.lat,lng:+e.long,address:e.address})):(new google.maps.Geocoder).geocode({address:e.description},function(e,t){if("OK"===t&&e[0]){var r=e[0].geometry.location.lat(),n=e[0].geometry.location.lng(),o=e[0].formatted_address;a.setState({address:o,originAddress:o}),i({customerLat:r,customerLng:n,customerAddress:o}),c({lat:r,lng:n,address:o})}})}},{key:"checkSubmitButtonDisabled",value:function(){var e=this.props,t=e.orderingMethodStatus,r=e.suspendStatus,n=e.orderPriceStatus,o=e.isLoggedIn,a=e.orderInfo,i=e.distance,c=e.btnSubmitDisabled,s=e.paymentForm,l=e.paymentMethod,u=e.orderItems,d=e.orderType,m=e.deliveryFeeErrorObject;if("op"===l&&(!s.card_number||!s.card_expiry_date||!s.card_cvn||0<Object.keys(s.error).length))return!0;if(u.some(function(e){return d===H.b.DELIVERY&&(e.disallow_delivery||1===e.disallow_delivery)||d===H.b.TAKE_AWAY&&(e.disallow_takeaway||1===e.disallow_takeaway)}))return!0;if(a.order_type===H.b.DELIVERY&&m&&2!==m.code)return!0;if(!this.checkDeliveryRange())return!0;var p=a.online_order_setting;return!o||c||!t||!r||3!==n||a.order_type===H.b.DELIVERY&&p.delivery_distance&&i>p.delivery_distance||a.order_type===H.b.DELIVERY&&(!a.customerAddress||!a.customerLat||!a.customerLng)}},{key:"createOrder",value:function(){this.checkSubmitButtonDisabled()||this.props.onCreateOrder()}},{key:"toggleMapMobile",value:function(){this.setState({mapMobileOpened:!this.state.mapMobileOpened})}},{key:"onChangePaymentMethod",value:function(e){var t=this.props,r=t.paymentMethod,n=t.changePaymentMethod,o=e.target.value;r!==o&&n(o)}},{key:"render",value:function(){var n=this,e=this.props,t=e.t,r=e.lang,o=e.orderInfo,a=e.isLoggedIn,i=e.customer,c=e.totalPrice,s=e.toggleMap,l=e.customerLat,u=e.customerLng,d=e.mapOpened,m=e.orderType,p=e.distance,f=e.duration,h=e.deliveryFee,y=e.updateDirections,g=e.deliveryFeeErrorObject,v=(e.updatePaymentForm,e.paymentMethod),b=e.waitForPay,E=this.state,O=E.phone,_=E.otp,L=E.countryCode,S=E.verifying,w=E.countriesListShow,N=E.address,k=E.addressNote,j=E.mapMobileOpened,A=E.btnNextDisabled,D=E.btnVerifyDisabled,I=E.authErrorMessage,C=E.showPredictions,P=E.predictions,R=(E.passVerifying,E.password_token,E.forgotPass,E.forgotPassVerifying,E.forgotPass_token,E.email,E.dob,E.error,H.k.find(function(e){return e.country_code===L})),T=o.translations?o.translations.find(function(e){return e.lang_iso_code===r}):null,M=T&&T.name||o.name||"",V=o.logo,x=o.currency.symbol,B=this.checkSubmitButtonDisabled(),F=this.checkDeliveryRange();return U.a.createElement("div",{className:"checkout-info"},b&&U.a.createElement(ce.a,null),U.a.createElement("div",{className:"restaurant-info"},U.a.createElement("div",{className:"img-wrapper"},U.a.createElement(Y.a,{src:V,width:40,height:40})),U.a.createElement("div",{className:"detail"},U.a.createElement("h4",{title:M},U.a.createElement(J.Link,{to:"/".concat(o.slug)},M)),U.a.createElement("div",{className:"address-wrapper"},U.a.createElement("div",{className:"address",title:o.address},o.address),U.a.createElement("div",{className:"map-toggle d-none d-lg-block",onClick:s},t(d?"LABEL.HIDE":"LABEL.SHOW")),U.a.createElement("div",{className:"map-toggle d-lg-none",onClick:this.toggleMapMobile},t(j?"LABEL.HIDE":"LABEL.SHOW"))),U.a.createElement("a",{className:"phone",href:"tel:+".concat(o.country_code).concat(o.phone)},"+",o.country_code," ",o.phone))),U.a.createElement(ie,{updateDirections:y,customerLat:l,customerLng:u,mapOpened:j}),!a&&U.a.createElement("div",{className:"not-logged"},!S&&U.a.createElement("label",null,t("LABEL.CART_PHONE")),S&&U.a.createElement("label",{className:"phone-verifying"},U.a.createElement("i",{className:"icon-hottab-arrow-left",onClick:function(){return n.back()}}),"+",L," ",O),S&&U.a.createElement("p",{className:"otp-label"},t("LABEL.OTP_SEND_MESSAGE")),U.a.createElement("div",{className:"input-wrapper"},!S&&U.a.createElement("input",{ref:function(e){return n.phoneRef=e},type:"text",name:"phone",value:O,onKeyPress:this.onKeyPress,onChange:function(e){return n.handleInputChange(e,!0)}}),S&&U.a.createElement("input",{ref:function(e){return n.otpRef=e},type:"text",className:"input-otp",name:"otp",placeholder:t("LABEL.CODE_OTP"),value:_,onChange:function(e){return n.handleInputChange(e,!0)}}),!S&&U.a.createElement("div",{className:"countries-data"},U.a.createElement("div",{className:"countries-toggle",onClick:function(){return n.toggleCountriesList()}},U.a.createElement(Q.a,{code:R.alpha2,svg:!0}),"+ ",R.country_code,U.a.createElement("i",{className:"icon-hottab-angle-".concat(w?"up":"down")})),w&&U.a.createElement("div",{className:"countries-wrapper",ref:function(e){return n.countriesRef=e}},H.k.map(function(e,t){var r=e.country_code===L;return U.a.createElement("div",{className:"country cleafix ".concat(r?"selected":""),onClick:function(){return n.changeCountryCode(e.country_code)},key:t},e.alpha2&&U.a.createElement(Q.a,{code:e.alpha2,svg:!0}),U.a.createElement("div",{className:"country-name"},e.name),U.a.createElement("div",{className:"country-code"},"+ ",e.country_code))})))),I&&U.a.createElement("div",{className:"auth-error-message"},I),!S&&U.a.createElement("button",{className:"btn btn-type-2 ".concat(0<O.length?"visible":""," ").concat(A?"disabled":""),onClick:function(){return n.sendOtp()}},t("BUTTON.NEXT"),U.a.createElement("i",{className:"icon-hottab-arrow-right"})),S&&U.a.createElement("button",{className:"btn btn-type-2 btn-verify ".concat(D?"disabled":""),onClick:function(){return n.login()}},t("BUTTON.SEND_OTP"),U.a.createElement("i",{className:"icon-hottab-arrow-right"})),U.a.createElement("div",{className:"grey-block"},U.a.createElement("div",null,t("LABEL.DELIVERY_ADDRESS")),U.a.createElement("div",null,t("LABEL.PAYMENT_METHOD")))),a&&U.a.createElement("div",{className:"logged"},U.a.createElement("div",{className:"user-info"},i.phone&&U.a.createElement("div",{className:"phone"},"+",i.country_code," ",i.phone,U.a.createElement("i",{className:"icon-hottab-check"})),i.name&&U.a.createElement("div",{className:"name"},i.name)),U.a.createElement("div",{className:"address-container ".concat(3===m?"":"d-none")},U.a.createElement("label",null,t("LABEL.DELIVERY_ADDRESS"),F&&0<f/60&&U.a.createElement("span",null," · ",Math.ceil(f/60)," ",t("UNIT.min")),0<p&&U.a.createElement("span",null,Object(H.I)(p,1)," ",Z.f),F&&!g&&U.a.createElement("span",null,0<h?Object(H.s)(h,x):t("LABEL.FREE_SHIPPING")," · "),F&&g&&U.a.createElement("span",null,0<g.fee?Object(H.s)(g.fee,x):t("LABEL.FREE_SHIPPING")," · ")),!F&&U.a.createElement("div",{className:"distance-validate"},t("LABEL.OUT_OF_DELIVERY_RANGE")),U.a.createElement("div",{className:"address-wrapper"},U.a.createElement("input",{type:"text",className:"d-none",name:"address",value:""}),U.a.createElement("input",{type:"text",ref:function(e){return n.addressRef=e},placeholder:t("LABEL.CART_ADDRESS"),name:"address",autoComplete:"new-password",onFocus:this.onFocusAddress,value:N,onChange:this.handleInputChange}),!N&&U.a.createElement("span",{className:"input-error"},t("VALIDATE.CART_SELECT_ADDRESS_FROM_SUGGESTION")),C&&0<P.length&&U.a.createElement("div",{className:"predictions",ref:function(e){return n.predictionsRef=e}},P.map(function(e,t){return U.a.createElement("div",{className:"prediction-item",onClick:function(){return n.choosePrediction(e)},key:t},U.a.createElement("i",{className:"icon-hottab-gps"}),e.name&&U.a.createElement("h4",{title:e.name},e.name),e.address&&U.a.createElement("p",null,e.address),e.description&&U.a.createElement("p",null,e.description))}))),U.a.createElement("input",{type:"text",placeholder:t("LABEL.ADDRESS_NOTE"),name:"addressNote",autoComplete:"new-password",value:k,onChange:this.handleInputChange})),U.a.createElement("div",{className:"payment"},U.a.createElement("label",null,t("LABEL.PAYMENT_METHOD")),U.a.createElement("div",{className:"payment-wrapper"},U.a.createElement("div",{className:"payment-method"},U.a.createElement("label",{className:"styled-radio"},U.a.createElement("input",{type:"radio",value:"cod",checked:"cod"===v,onChange:this.onChangePaymentMethod}),U.a.createElement("span",{className:"checkmark"}),U.a.createElement("span",{className:"payment-text"},t("LABEL.COD"))))))),a&&U.a.createElement("button",{disabled:B,className:"btn btn-type-2 btn-place-order",onClick:function(){return n.createOrder()}},t("BUTTON.PLACE_ORDER")," · ",Object(H.s)(c,x)))}}])&&fe(t.prototype,r),o&&fe(t,o),n}())||ae)||ae,Ee=r(714),Oe=r(209),_e=r(725);r(1058);function Le(e){return(Le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Se(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function we(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ne(e){return(Ne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ke(e,t){return(ke=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function je(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Ae=Object(i.translate)("translations")(ve=Object(a.connect)(function(e){return{lang:e.config.lang,isLoggedIn:e.auth.loggedIn,token:e.auth.token,address:e.auth.address,orderType:e.config.order_type,orderItems:e.order.items,orderInfo:e.order.info,customer:e.auth.customer,paymentMethod:e.config.paymentMethod,customerLat:e.config.customerLat,customerLng:e.config.customerLng}},{updateOrderInfo:x.j,resetOrder:x.f,replaceAddress:le.b})(ve=function(e){function n(e){var y,t,r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),t=this,r=Ne(n).call(this,e),(y=!r||"object"!==Le(r)&&"function"!=typeof r?je(t):r).updatePaymentForm=function(e){y.setState({paymentForm:{card_number:e.card_number,card_expiry_date:e.card_expiry_date,card_cvn:e.card_cvn,error:e.error}})},y.getDeliveryFeeErrorObject=function(){var e=y.props,t=e.orderItems,r=e.orderInfo,n=y.state.distance,o=r.online_order_setting,a=Object(H.f)(t),i=n?Object(H.I)(n/1e3,3):0;if(Object(H.u)(a,i,o.delivery_fee_setting))return null;var c=Object(H.u)(a,i,o.delivery_fee_setting,!0),s=null;if(c){var l=!0,u=!1,d=void 0;try{for(var m,p=c.condition[Symbol.iterator]();!(l=(m=p.next()).done);l=!0){var f=m.value;if("order_total"===f.key){var h=1===c.amount_type?c.amount:i?c.amount*i:c.amount;(">"===f.operation&&a<=f.value||">="===f.operation&&a<f.value)&&(s={code:1,value:f.value-a,fee:h}),("<"===f.operation&&a>=f.value||"<="===f.operation&&a>f.value)&&(s={code:2,value:a-f.value,fee:h})}}}catch(e){u=!0,d=e}finally{try{l||null==p.return||p.return()}finally{if(u)throw d}}}return s},y.state={mapOpened:!0,distance:null,duration:null,btnSubmitDisabled:!1,vouchers:[],orderVouchers:[],paymentForm:{},totalAmount:"",subTotal:"",taxes:[],voucherAmount:"",deliveryFee:"",waitForPay:!1,paymentWin:"",windowInterval:""},y.toggleMap=y.toggleMap.bind(je(je(y))),y.updateDirections=y.updateDirections.bind(je(je(y))),y.selectVoucher=y.selectVoucher.bind(je(je(y))),y.clearVoucherError=y.clearVoucherError.bind(je(je(y))),y.checkPaymentStatus=y.checkPaymentStatus.bind(je(je(y))),y}var t,r,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ke(e,t)}(n,U.a.Component),t=n,(r=[{key:"componentDidMount",value:function(){var e=this.props,t=e.isLoggedIn,r=e.orderInfo;e.lang,this.state.totalAmount;this.getRestaurantData(),t&&this.getAvailableVouchers(r.outlet_uuid),this.calculateTotalPrice()}},{key:"componentDidUpdate",value:function(e){var t=this.props,r=t.isLoggedIn,n=t.orderInfo;r&&r!==e.isLoggedIn&&this.getAvailableVouchers(n.outlet_uuid)}},{key:"getAvailableVouchers",value:function(e){var t=this,r=this.props.token;Object(_e.d)(e,r).then(function(e){e&&e.data&&t.setState({vouchers:e.data})})}},{key:"getRestaurantData",value:function(){var e=this.props,t=e.orderInfo,r=e.updateOrderInfo;Object(Oe.c)(t.outlet_uuid).then(function(e){e&&(e.error||r(e.data))})}},{key:"toggleMap",value:function(){this.setState({mapOpened:!this.state.mapOpened})}},{key:"checkOrderingMethodValid",value:function(){var e=this.props,t=e.orderInfo,r=e.orderType,n=Object(H.g)(H.b.DELIVERY,t),o=Object(H.g)(H.b.TAKE_AWAY,t);return!(r===H.b.DELIVERY&&!n)&&!(r===H.b.TAKE_AWAY&&!o)}},{key:"checkSuspendOrderingMethod",value:function(){var e=this.props,t=e.orderInfo,r=e.orderType,n=t.online_order_setting;return!(r===H.b.DELIVERY&&n.suspend_delivery||r===H.b.TAKE_AWAY&&n.suspend_takeaway)}},{key:"calculateTotalPrice",value:function(){var e=this.props,t=e.orderItems,r=e.orderInfo,n=e.isLoggedIn,o=this.state,a=o.distance,i=o.vouchers,c=Object(H.f)(t),s=r.online_order_setting,l=s.consumer_taxes,u="string"==typeof l?JSON.parse(l):l,d=[];r.categories&&(d=Object(H.z)(t,u,r.categories));var m=d.reduce(function(e,t){return e+t.amount},0),p=n&&r.order_type===H.b.DELIVERY?s.delivery_fee:0,f=a?Object(H.I)(a/1e3,3):0;n&&r.order_type===H.b.DELIVERY&&s.delivery_fee_setting&&a&&(p=Object(H.d)(p,c,f,s.delivery_fee_setting));var h=i.filter(function(e){return e.selected}).reduce(function(e,t){return e+t.amount},0),y=c*(2===(0<i.length?i[0].type:1)?s.max_shared_percent_voucher:s.max_rewarded_percent_voucher)/100,g=h<y?h:y,v=c+m+p-g;r.currency.symbol;this.setState({totalAmount:v,subTotal:c,taxes:d,voucherAmount:g,deliveryFee:p})}},{key:"updateDirections",value:function(e){e&&this.setState({distance:e.routes[0].legs[0].distance.value,duration:e.routes[0].legs[0].duration.value})}},{key:"createOrder",value:function(){var t=this,e=this.props,n=e.t,o=e.token,r=e.orderItems,a=e.orderInfo,i=e.customer,c=e.resetOrder,s=e.address,l=e.replaceAddress,u=e.paymentMethod,d=e.lang,m=this.state,p=m.btnSubmitDisabled,f=m.orderVouchers;m.totalAmount;if(!p){this.setState({btnSubmitDisabled:!0}),this.setState({waitForPay:!0});var h={country_code:i.country_code,customer_email:i.email,customer_name:i.name,customer_phone:i.phone,customer_uuid:i.customer_uuid},y=[],g=!0,v=!1,b=void 0;try{for(var E,O=r[Symbol.iterator]();!(g=(E=O.next()).done);g=!0){var _=E.value,L=[];if(_.item_options){var S=!0,w=!1,N=void 0;try{for(var k,j=_.item_options[Symbol.iterator]();!(S=(k=j.next()).done);S=!0){var A=k.value;L.push(A.option_uuid)}}catch(e){w=!0,N=e}finally{try{S||null==j.return||j.return()}finally{if(w)throw N}}}y.push({item_uuid:_.item_uuid,item_quantity:_.quantity||1,item_options:L})}}catch(e){v=!0,b=e}finally{try{g||null==O.return||O.return()}finally{if(v)throw b}}if(a.order_type===H.b.DELIVERY){h.customer_address=a.customerAddress,h.customer_lat=a.customerLat,h.customer_long=a.customerLng,h.address_note=a.addressNote;var D=s.find(function(e){return+e.lat===Object(H.I)(a.customerLat,7)&&+e.long===Object(H.I)(a.customerLng,7)});D&&(h.address_uuid=D.cus_address_uuid)}var I={customer:h,items:y,vouchers:Se(f),order_type:a.order_type,order_note:a.orderNote,lang:d};"op"===u&&(I.payment_method="viettelpay"),Object(_e.c)(I,o).then(function(e){if(e&&!e.error){var t=e.data.order.uuid;if("cod"===u)P.a.push("/order/".concat(t,"?create=true")),C.toast.info(n("TOAST.createOrder")),c(),Object(se.b)(i.customer_uuid,o).then(function(e){if(!e.error){var t=e.data.addresses;l(t)}});else{var r=e.data.payment_url;r&&window.location.replace(r)}}}).catch(function(e){C.toast.error(Object(H.n)(e.message)),t.setState({btnSubmitDisabled:!1}),t.setState({waitForPay:!1})})}}},{key:"checkPaymentStatus",value:function(t){var r=this,e=this.props,n=e.token,o=e.t;Object(_e.f)(t,n).then(function(e){9===e.data.order.status?(C.toast.error(Object(H.n)(o("ERROR_CUSTOM_CODE.PAYMENT_FAILED"))),r.setState({btnSubmitDisabled:!1}),r.setState({waitForPay:!1})):(P.a.push("/order/".concat(t,"?create=true")),C.toast.info(o("TOAST.createOrder")))}).catch(function(e){C.toast.error(Object(H.n)(e.message)),r.setState({btnSubmitDisabled:!1}),r.setState({waitForPay:!1})})}},{key:"isPaymentWindowOpen",value:function(e){var t=this.state,r=t.paymentWin,n=t.windowInterval;r&&r.closed&&(window.clearInterval(n),alert("closed"))}},{key:"selectVoucher",value:function(e){var t=this.props,r=t.orderInfo,n=t.orderItems,o=t.t,a=this.state.vouchers,i=r.online_order_setting,c=e.voucher_uuid,s=Object(H.f)(n),l=a.filter(function(e){return e.selected}),u=l.reduce(function(e,t){return e+t.amount},0);a.map(function(e){return e.active=!1,e.voucher_uuid===c&&(e.active=!0),e});var d=i.multiple_vouchers_allowed;if(!e.selected&&!d&&0<l.length){var m=a.map(function(e){return e.voucher_uuid===c&&(e.errorMessage=o("ERROR_CUSTOM_CODE.VOUCHER_NUMBER_EXCEEDED")),e});this.setState({vouchers:m})}else if(!e.selected&&0<l.length&&l[0].type!==e.type&&(2===l[0].type&&2!==e.type||2!==l[0].type&&2===e.type)){var p=a.map(function(e){return e.voucher_uuid===c&&(e.errorMessage=o("ERROR_CUSTOM_CODE.VOUCHER_MIX")),e});this.setState({vouchers:p})}else{var f=0,h=s*(f=2===e.type?i.max_shared_percent_voucher:i.max_rewarded_percent_voucher)/100;if(!e.selected&&h<u){var y=a.map(function(e){return e.voucher_uuid===c&&(e.errorMessage=o("ERROR_CUSTOM_CODE.VOUCHER_AMOUNT_EXCEEDED").replace("%@",f)),e});this.setState({vouchers:y})}else{var g=a.map(function(e){return e.voucher_uuid===c&&(e.selected=!e.selected),e}),v=Object(H.l)(this.state.orderVouchers);v=v.includes(c)?v.filter(function(e){return e!==c}):Se(v).concat([c]),this.setState({vouchers:g,orderVouchers:v})}}}},{key:"clearVoucherError",value:function(){var e=this.state.vouchers.map(function(e){return e.errorMessage="",e});this.setState({vouchers:e})}},{key:"render",value:function(){var t=this,e=this.props,r=e.t,n=e.orderItems,o=e.orderInfo,a=e.isLoggedIn,i=e.customerLat,c=e.customerLng,s=e.paymentMethod,l=this.state,u=l.mapOpened,d=l.distance,m=l.duration,p=l.btnSubmitDisabled,f=l.vouchers,h=l.paymentForm,y=l.taxes,g=l.subTotal,v=l.voucherAmount,b=l.deliveryFee,E=l.waitForPay;if(0===n.length)return P.a.push("/"),null;var O=o.online_order_setting,_=d?Object(H.I)(d/1e3,3):0,L=g,S=this.checkOrderingMethodValid(),w=this.checkSuspendOrderingMethod(),N=Object(H.M)(o,L),k=this.state.totalAmount,j=o.currency.symbol,A=this.getDeliveryFeeErrorObject(),D=Object(H.u)(L,_,O.delivery_fee_setting,!0);return U.a.createElement("div",{className:"checkout"},U.a.createElement(Ee.a,null),U.a.createElement("div",{className:"checkout-container container"},U.a.createElement(z,{subtotal:L,orderPriceStatus:N,totalPrice:k,taxes:y,vouchers:f,voucherAmount:v,deliveryFeeErrorObject:A,deliveryFeeObject:D,clearVoucherError:this.clearVoucherError,selectVoucher:this.selectVoucher,deliveryFee:b}),U.a.createElement("div",{className:"info-wrapper"},a&&U.a.createElement("div",{className:"checkout-error"},U.a.createElement("ol",{className:"error-message"},!S&&w&&U.a.createElement("li",null,r("VALIDATE.CART_WRONG_ORDER_TIME")),!w&&U.a.createElement("li",null,r("VALIDATE.SUSPEND_METHOD")),S&&w&&o.order_type===H.b.DELIVERY&&A&&1===A.code&&U.a.createElement("li",null,Object(H.o)(r("VALIDATE.DELIVERY_ORDER_ADD_MORE"),Object(H.s)(A.value,j))))),U.a.createElement(be,{subtotal:L,orderPriceStatus:N,btnSubmitDisabled:p,waitForPay:E,totalPrice:k,distance:_,duration:m,mapOpened:u,deliveryFee:b,deliveryFeeErrorObject:A,deliveryFeeObject:D,toggleMap:this.toggleMap,orderingMethodStatus:S,suspendStatus:w,updateDirections:this.updateDirections,paymentMethod:s,paymentForm:h,updatePaymentForm:this.updatePaymentForm,onCreateOrder:function(){return t.createOrder()}}),U.a.createElement(ie,{updateDirections:this.updateDirections,customerLat:i,customerLng:c,mapOpened:u}),U.a.createElement("form",{method:"POST",className:"d-none",ref:function(e){return t.paymentFormRef=e}}))))}}])&&we(t.prototype,r),o&&we(t,o),n}())||ve)||ve;t.default=Ae},714:function(e,t,r){"use strict";var n=r(0),o=r.n(n),a=r(718);t.a=function(){return o.a.createElement(a.Helmet,null,o.a.createElement("title",null,"#SOPA: Online order and Marketing Platform"))}},725:function(e,t,r){"use strict";r.d(t,"c",function(){return o}),r.d(t,"f",function(){return a}),r.d(t,"d",function(){return i}),r.d(t,"e",function(){return c}),r.d(t,"g",function(){return s}),r.d(t,"a",function(){return l}),r.d(t,"b",function(){return u});var n=r(10);var o=function(e,t){return Object(n.b)("/orders",e,"POST",t,"order")},a=function(e,t){return Object(n.a)("/orders",{order_uuid:e},t,"order")},i=function(e,t){return Object(n.a)("/customer/vouchers/available",{outlet_uuid:e},t)},c=function(e,t,r){return Object(n.a)("/customer/vouchers",{status:e,page:t},r)},s=function(e){return Object(n.a)("/customer/vouchers/".concat(e))},l=function(e,t){return Object(n.b)("/customer/vouchers/".concat(e,"/claim"),null,"POST",t)},u=function(e,t,r){return Object(n.b)("/customer/vouchers/".concat(e,"/convert"),function(o){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{},t=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),t.forEach(function(e){var t,r,n;t=o,n=a[r=e],r in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n})}return o}({},t),"POST",r)}},733:function(e,t,r){"use strict";r.d(t,"a",function(){return n});var n=[{featureType:"water",elementType:"geometry",stylers:[{color:"#e9e9e9"},{lightness:17}]},{featureType:"landscape",elementType:"geometry",stylers:[{color:"#f5f5f5"},{lightness:20}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:"#ffffff"},{lightness:17}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#ffffff"},{lightness:29},{weight:.2}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#ffffff"},{lightness:18}]},{featureType:"road.local",elementType:"geometry",stylers:[{color:"#ffffff"},{lightness:16}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#f5f5f5"},{lightness:21}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#dedede"},{lightness:21}]},{elementType:"labels.text.stroke",stylers:[{visibility:"on"},{color:"#ffffff"},{lightness:16}]},{elementType:"labels.text.fill",stylers:[{saturation:36},{color:"#333333"},{lightness:40}]},{elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#f2f2f2"},{lightness:19}]},{featureType:"administrative",elementType:"geometry.fill",stylers:[{color:"#fefefe"},{lightness:20}]},{featureType:"administrative",elementType:"geometry.stroke",stylers:[{color:"#fefefe"},{lightness:17},{weight:1.2}]}]},739:function(e,t,r){"use strict";var n=r(0),o=r.n(n),a=r(746),i=r(762),c=r(736),s=r(63),l=r(2),u=r(733);var d=Object(c.compose)(Object(c.withProps)({googleMapURL:"https://maps.googleapis.com/maps/api/js?libraries=places&key=".concat(s.g),loadingElement:o.a.createElement("div",{style:{height:"100%"}}),containerElement:o.a.createElement("div",{className:"map-wrapper"}),mapElement:o.a.createElement("div",{style:{height:"100%"}})}),a.withGoogleMap,Object(c.lifecycle)({componentDidMount:function(){var n=this;this.props.onMapLoad&&this.props.onMapLoad();var e=this.props,t=e.customerLat,r=e.customerLng,o=e.restaurantLat,a=e.restaurantLng,i=e.renderOnMount,c=e.updateDirections;i&&t&&r&&(new google.maps.DirectionsService).route({origin:new google.maps.LatLng(o,a),destination:new google.maps.LatLng(t,r),travelMode:google.maps.TravelMode.DRIVING,optimizeWaypoints:!0,provideRouteAlternatives:!0},function(e,t){if(t===google.maps.DirectionsStatus.OK){var r=function(o){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{},t=Object.keys(a);"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(a).filter(function(e){return Object.getOwnPropertyDescriptor(a,e).enumerable}))),t.forEach(function(e){var t,r,n;t=o,n=a[r=e],r in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n})}return o}({},e,{routes:Object(l.l)(e.routes).sort(function(e,t){return e.legs[0].distance.value-t.legs[0].distance.value}).filter(function(e,t){return 0===t})});n.setState({directions:r}),c&&c(r)}})},componentDidUpdate:function(e){var r=this,t=this.props,n=t.customerLat,o=t.customerLng,a=t.restaurantLat,i=t.restaurantLng,c=t.updateDirections;n&&e.customerLat!==n&&o&&e.customerLat!==n&&(new google.maps.DirectionsService).route({origin:new google.maps.LatLng(a,i),destination:new google.maps.LatLng(n,o),travelMode:google.maps.TravelMode.DRIVING},function(e,t){t===google.maps.DirectionsStatus.OK&&(r.setState({directions:e}),c&&c(e))})}}))(function(e){return o.a.createElement(a.GoogleMap,{center:e.center,zoom:e.zoom,defaultOptions:{styles:u.a,mapTypeControl:!1,zoomControl:!1,streetViewControl:!1}},e.directions&&e.renderDirections&&o.a.createElement(a.DirectionsRenderer,{directions:e.directions}),(!e.directions||!e.renderDirections)&&o.a.createElement(i.MarkerWithLabel,{position:e.center,labelAnchor:new google.maps.Point(12,12),icon:"1"},o.a.createElement("img",{src:"/images/marker.png",alt:"",style:{width:"24px",height:"24px"}})))});t.a=d}}]);